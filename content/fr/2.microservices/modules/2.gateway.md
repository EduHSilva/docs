---
title: Gateway
description: Documentação do módulo de Gateway de API.
navigation:
  icon: i-lucide-route
seo:
  description: Documentação técnica do módulo de Gateway, responsável pela centralização, roteamento e segurança das requisições para os microsserviços.
---

# Objetivo

O **Gateway de API** atua como o ponto de entrada unificado para todas as requisições externas, sendo fundamental para a arquitetura de microsserviços. Seu objetivo principal é **centralizar e padronizar** as chamadas entre os clientes (front-ends, aplicativos móveis, etc.) e os microsserviços de backend.

O Gateway desempenha três funções cruciais:

- **Ponto Único de Entrada:** Simplifica a comunicação, expondo uma única URL para o sistema.
- **Validador de Autenticação:** Intercepta e valida tokens de segurança (JWT) antes de encaminhar a requisição.
- **Roteador de Requisições:** Direciona o tráfego para o microsserviço correto com base na URL da requisição.

## Rotas e Roteamento

O roteamento é dinâmico e baseado no nome do serviço. Todo microsserviço registrado no *Service Discovery* fica acessível através do seguinte padrão de URL:

```
{{url}}/{nome-do-servico}
```

### Rota Pública de Teste (`/ping`)

Cada microsserviço deve expor uma rota pública `/ping` para que o Gateway possa validar sua disponibilidade e saúde (Health Check).

```http request
GET {{url}}/users/ping
```

**Resposta de Sucesso (200 OK):**

```json
{
  "data": null,
  "links": null,
  "message": "Serviço disponível (pong)"
}
```

## Rotas Autenticadas

Para acessar qualquer rota protegida por autenticação, o cliente deve incluir o cabeçalho `Authorization` com o token JWT:

```
Authorization: Bearer <token>
```

Ao receber uma requisição com este cabeçalho, o Gateway executa o seguinte fluxo de segurança:

1.  **Validação do Token JWT:** Verifica a assinatura e a validade do token.
2.  **Extração do Usuário:** Decodifica o token para identificar o usuário autenticado.
3.  **Repasse da Requisição:** Encaminha a requisição ao microsserviço de destino, injetando o ID do usuário autenticado no cabeçalho `X-User-ID`.

O microsserviço de destino pode, então, confiar que o usuário já foi autenticado e autorizado pelo Gateway, e utilizar o cabeçalho `X-User-ID` para identificar o usuário logado.

**Cabeçalho Injetado:**

```
X-User-ID: <id-do-usuario-autenticado>
```

## Observações

- **Segurança Centralizada:** A validação de segurança é feita em um único ponto, simplificando a lógica nos microsserviços.
- **Desacoplamento:** O Gateway permite que os microsserviços sejam desenvolvidos e implantados de forma independente, sem que os clientes precisem conhecer seus endereços internos.
