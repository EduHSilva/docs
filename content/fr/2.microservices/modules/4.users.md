---
title: Usu√°rios
description: Documenta√ß√£o do m√≥dulo de usu√°rios.
navigation:
  icon: i-lucide-user
seo:
  description: Documenta√ß√£o detalhada sobre o m√≥dulo de usu√°rios, incluindo autentica√ß√£o, gerenciamento de perfis e rotas da API.
---

# Objetivo

O m√≥dulo de **usu√°rios** tem como principal objetivo gerenciar o ciclo de vida e a autentica√ß√£o dos usu√°rios na plataforma. Ele fornece uma base segura e robusta para controle de acesso, garantindo que apenas usu√°rios autorizados possam interagir com os recursos do sistema.

# Responsabilidades

Este m√≥dulo √© respons√°vel por um conjunto de funcionalidades cr√≠ticas relacionadas √† identidade e ao acesso dos usu√°rios. As principais responsabilidades incluem:

- **Autentica√ß√£o de Usu√°rios:** Validar credenciais (e-mail e senha) para permitir o acesso ao sistema.
- **Emiss√£o e Valida√ß√£o de JWT:** Gerar e verificar JSON Web Tokens (JWT) para autentica√ß√£o stateless em requisi√ß√µes subsequentes.
- **Gerenciamento de Pap√©is e Status:** Atribuir e controlar os pap√©is (roles) e o status (ativo, pendente, etc.) de cada usu√°rio.
- **Integra√ß√£o com M√≥dulo de E-mail:** Coordenar com o servi√ßo de e-mails para enviar notifica√ß√µes, como a confirma√ß√£o de cadastro.

# Rotas da API

A seguir, s√£o detalhadas as rotas dispon√≠veis na API para intera√ß√£o com o m√≥dulo de usu√°rios.

## Autentica√ß√£o (`/auth`)

### üîí `me`

Esta rota √© utilizada para verificar a validade de um token de autentica√ß√£o. √â ideal para ser usada em middlewares de prote√ß√£o de rotas, garantindo que o usu√°rio esteja autenticado antes de acessar recursos restritos.

```http request
GET {{url}}/users/auth/me
Authorization: Bearer {token}
```

**Resposta de Sucesso (200 OK):**

```json
{
  "data": {
    "id": "fedf607f-0fd1-4c82-ace4-c36408002400",
    "username": "Eduardo Henrique",
    "email": "edu.slhenrique@gmail.com",
    "token": null
  },
  "links": null,
  "message": "Autentica√ß√£o verificada com sucesso."
}
```

### üîì `login`

Rota destinada √† autentica√ß√£o do usu√°rio no sistema. O usu√°rio fornece suas credenciais e, se v√°lidas, recebe um token de acesso.

::warning
Esta rota **n√£o permite** o login de usu√°rios que ainda n√£o confirmaram seu e-mail. Para mais detalhes, consulte a [regra de neg√≥cio](#rn3-autentica√ß√£o-p√≥s-confirma√ß√£o).
::

```http request
POST {{url}}/users/auth/login
Content-Type: application/json

{
  "email": "edu.slhenrique@gmail.com",
  "password": "12345678"
}
```

**Resposta de Sucesso (200 OK):**

```json
{
  "data": {
    "id": "fedf607f-0fd1-4c82-ace4-c36408002400",
    "username": "Eduardo Henrique",
    "email": "edu.slhenrique@gmail.com",
    "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJhdXRoIiwic3ViIjoiZmVkZjYwN2YtMGZkMS00YzgyLWFjZTQtYzM2NDA4MDAyNDAwIiwiZXhwIjoxNzY2NDYwNzUyfQ.UbkVFMbgvJ_DbQ9fFQ3ElRNAImBS8ct7yNmFi4tMVBo"
  },
  "links": null,
  "message": "Usu√°rio autenticado com sucesso."
}
```

## Usu√°rio (`/users`)

### üîí `all`

Esta rota √© respons√°vel por listar todos os usu√°rios cadastrados no sistema. O acesso √© restrito e requer privil√©gios administrativos.

::warning
O acesso a esta rota **exige o papel (role) de `ADMIN`**. Para mais detalhes, consulte a [regra de neg√≥cio](#rn4-acesso-√†-lista-de-usu√°rios).
::

```http request
GET {{url}}/users
Authorization: Bearer {token}
```

**Resposta de Sucesso (200 OK):**

```json
{
  "data": {
    "items": [
      {
        "createdDate": "2020-01-01T03:00:00.000Z",
        "email": "edu.slhenrique@gmail.com",
        "id": "fedf607f-0fd1-4c82-ace4-c36408002400",
        "role": "ADMIN",
        "status": "OK",
        "username": "Eduardo Henrique"
      }
    ],
    "page": 0,
    "size": 10,
    "total": 1
  },
  "links": {
    "self": "/users?page=0&size=10"
  },
  "message": "Usu√°rios encontrados com sucesso."
}
```

### üîí `findOne`

Rota utilizada para buscar um usu√°rio espec√≠fico pelo seu `id`.

```http request
GET {{url}}/users/{id}
Authorization: Bearer {token}
```

**Resposta de Sucesso (200 OK):**

```json
{
  "data": {
    "createdDate": "2020-01-01T03:00:00.000Z",
    "email": "edu.slhenrique@gmail.com",
    "id": "fedf607f-0fd1-4c82-ace4-c36408002400",
    "role": "ADMIN",
    "status": "OK",
    "username": "Eduardo Henrique"
  },
  "links": {
    "edit": "/users/fedf607f-0fd1-4c82-ace4-c36408002400",
    "self": "/users/fedf607f-0fd1-4c82-ace4-c36408002400",
    "delete": "/users/fedf607f-0fd1-4c82-ace4-c36408002400"
  },
  "message": "Usu√°rio encontrado com sucesso."
}
```

### üîì `save`

Esta rota √© respons√°vel por criar um novo usu√°rio no sistema.

::warning
Esta rota **n√£o permite** a cria√ß√£o de usu√°rios com o papel (role) de `ADMIN`. Para mais detalhes, consulte a [regra de neg√≥cio](#rn1-cria√ß√£o-de-administradores).
::

::warning
Todo usu√°rio √© criado com o status `WAITING_CONFIRMATION` e precisa confirmar seu e-mail para ativar a conta. Para mais detalhes, consulte a [regra de neg√≥cio](#rn2-confirma√ß√£o-de-usu√°rio).
::

```http request
POST {{url}}/users
Content-Type: application/json

{
    "email": "teste@gmail.com",
    "password": "12345678", 
    "username": "Teste",
    "role": "CRM"
}
```

**Resposta de Sucesso (201 Created):**

```json
{
    "data": {
        "createdDate": null,
        "email": "teste@gmail.com",
        "id": "b14be8e7-8a43-42c5-b84a-5f433a4c01a0",
        "role": "CRM",
        "status": "WAITING_CONFIRMATION",
        "username": "Teste"
    },
    "links": {
        "edit": "/users/b14be8e7-8a43-42c5-b84a-5f433a4c01a0",
        "self": "/users/b14be8e7-8a43-42c5-b84a-5f433a4c01a0",
        "delete": "/users/b14be8e7-8a43-42c5-b84a-5f433a4c01a0"
    },
    "message": "Usu√°rio salvo com sucesso."
}
```

### üîì `confirm`

Rota respons√°vel por confirmar o cadastro de um usu√°rio. Geralmente, √© acessada atrav√©s de um link enviado por e-mail.

```http request
GET {{url}}/users/confirm/{id}
```

Ap√≥s a confirma√ß√£o, o usu√°rio √© redirecionado para uma tela de sucesso, e seu status √© atualizado para `OK`.

### üîí `update`

Esta rota permite a atualiza√ß√£o das informa√ß√µes de um usu√°rio existente.

**Campos atualiz√°veis:**
- `username`

```http request
PUT {{url}}/users/{id}
Authorization: Bearer {token}
Content-Type: application/json

{
    "username": "Novo Nome de Usu√°rio"
}
```

**Resposta de Sucesso (200 OK):**

```json
{
    "data": {
        "createdDate": "2025-12-23T01:44:58.572Z",
        "email": "teste@gmail.com",
        "id": "b14be8e7-8a43-42c5-b84a-5f433a4c01a0",
        "role": "CRM",
        "status": "OK",
        "username": "Novo Nome de Usu√°rio"
    },
    "links": {
        "edit": "/users/b14be8e7-8a43-42c5-b84a-5f433a4c01a0",
        "self": "/users/b14be8e7-8a43-42c5-b84a-5f433a4c01a0",
        "delete": "/users/b14be8e7-8a43-42c5-b84a-5f433a4c01a0"
    },
    "message": "Usu√°rio atualizado com sucesso."
}
```

### üîí `delete`

Rota respons√°vel por remover um usu√°rio do sistema.

```http request
DELETE {{url}}/users/{id}
Authorization: Bearer {token}
```

**Resposta de Sucesso (200 OK):**

```json
{
  "data": null,
  "links": null,
  "message": "Usu√°rio deletado com sucesso."
}
```

## Regras de Neg√≥cio

#### RN1: Cria√ß√£o de Administradores
Por raz√µes de seguran√ßa, usu√°rios com o papel (role) de `ADMIN` n√£o podem ser criados diretamente via API. A atribui√ß√£o desse papel deve ser realizada por um processo interno seguro.

#### RN2: Confirma√ß√£o de Usu√°rio
Todo novo usu√°rio √© criado com um status que exige confirma√ß√£o (`WAITING_CONFIRMATION`). O usu√°rio permanecer√° bloqueado e n√£o poder√° se autenticar at√© que seu e-mail seja verificado.

#### RN3: Autentica√ß√£o P√≥s-Confirma√ß√£o
Um usu√°rio s√≥ poder√° realizar o login no sistema ap√≥s ter confirmado seu e-mail com sucesso. Tentativas de login de contas n√£o confirmadas ser√£o rejeitadas.

#### RN4: Acesso √† Lista de Usu√°rios
Apenas usu√°rios com o papel (role) de `ADMIN` t√™m permiss√£o para listar todos os usu√°rios cadastrados no sistema. Essa medida protege a privacidade dos dados dos usu√°rios.

#### RN5: Pap√©is (Roles) por M√≥dulo
Cada m√≥dulo do sistema deve ter um papel (role) espec√≠fico associado a ele. Isso permite um controle de acesso granular e organizado, garantindo que os usu√°rios tenham permiss√µes apenas para os recursos que necessitam.

## Observa√ß√µes

- Os pap√©is (roles) dispon√≠veis s√£o definidos no `enum UserRole` e devem ser atualizados manualmente no c√≥digo-fonte sempre que um novo m√≥dulo for adicionado ao sistema.
- Se o m√≥dulo de e-mail n√£o estiver configurado ou em uso, a confirma√ß√£o de novos usu√°rios dever√° ser realizada manualmente atrav√©s do endpoint `confirm` ou por uma interven√ß√£o direta no banco de dados.
